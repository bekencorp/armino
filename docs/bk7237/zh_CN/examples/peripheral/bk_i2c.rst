I2C
==========================

:link_to_translation:`en:[English]`

1 功能概述
-------------------------------------
	通过I2C接口完成对EEPROM芯片的数据读写。

2 代码路径
-------------------------------------
	demo路径：``components\bk_cli\cli_i2c.c``

3 cli命令简介
-------------------------------------

demo运行依赖的宏配置：

	+---------------------------+------------------------------------+--------------------------------------------+---------+
	|           NAME            |      Description                   |                  File                      |  value  |
	+===========================+====================================+============================================+=========+
	|CONFIG_I2C                 | support i2c                        | ``middleware\soc\bk7256\bk7256.defconfig`` |    y    |
	+---------------------------+------------------------------------+--------------------------------------------+---------+
	|CONFIG_SIM_I2C             | support use of gpio simulates i2c  | ``middleware\soc\bk7256\bk7256.defconfig`` |    y    |
	+---------------------------+------------------------------------+--------------------------------------------+---------+
	|CONFIG_I2C_SUPPORT_ID_BITS | number of i2c IDs support(binary)  | ``middleware\soc\bk7256\bk7256.defconfig`` |11(dec:3)|
	+---------------------------+------------------------------------+--------------------------------------------+---------+
	|CONFIG_FM_I2C              | iic used by FM                     | ``middleware\soc\bk7256\bk7256.defconfig`` |    n    |
	+---------------------------+------------------------------------+--------------------------------------------+---------+
	|CONFIG_CAMERA_USE_I2C1     | iic used by camera                 | ``middleware\soc\bk7256\bk7256.defconfig`` |    y    |
	+---------------------------+------------------------------------+--------------------------------------------+---------+

demo支持的命令如下表：

	+----------------------------------------+--------------------------------+---------------------------------------+
	|             Command                    |            Param               |              Description              |
	+========================================+================================+=======================================+
	| i2c_driver init                        | none                           | init I2C driver control memory        |
	+----------------------------------------+--------------------------------+---------------------------------------+
	| i2c_driver deinit                      | none                           | free all resource related to I2C      |
	+----------------------------------------+--------------------------------+---------------------------------------+
	| i2c {id} init                          | i2c id number                  | power up and start the I2C id         |
	+----------------------------------------+--------------------------------+---------------------------------------+
	| i2c {id} deinit                        | i2c id number                  | power down and Stop the I2C id        |
	+----------------------------------------+--------------------------------+---------------------------------------+
	|                                        | id: i2c id number              |                                       |
	| i2c {id} memory_write {data_size}      +--------------------------------+                                       |
	| {dev_addr}                             | data_size:size of data written | write data_size bytes of data to the  |
	|                                        +--------------------------------+ slave device with address dev_id      |
	|                                        | dev_addr: slave device address |                                       |
	+----------------------------------------+--------------------------------+---------------------------------------+
	|                                        | id: i2c id                     |                                       |
	| i2c {id} memory_read {data_size}       +--------------------------------+ read data_size bytes of data from     |
	|                                        | data_size:size of data read    | slave device                          |
	+----------------------------------------+--------------------------------+---------------------------------------+





4 演示介绍
-------------------------------------
	demo执行的步骤如下：

  1、准备好EEPROM的模块，型号为FM24C04B，连接方式如下：

   ::

	SCL----GPIO0
	SDA----GPIO1
	Vcc----3.3V

  2、顺序发送以下命令

   ::

	i2c_driver init

	i2c 1 init

	i2c 1 memory_write 8 50   //向EEPROM中写入8字节数据

	i2c 1 memory_read 8       //从EEPROM中读取8字节数据

.. note::

	注意：memory_write命令中的dev_addr 50为16进制，因为i2c驱动中会将dev_addr左移一位，所以传入的dev_addr需要将FM24C04B的dev_addr（1010b）右移一位。





