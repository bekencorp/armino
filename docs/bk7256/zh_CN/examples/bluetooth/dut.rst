DUT
========================

:link_to_translation:`en:[English]`

概述
--------------------------
	介绍如何进行蓝牙DUT测试，包括BLE的非信令测试以及BT的信令和非信令测试。

简介
--------------------------
1. BLE非信令测试

 - 搭建测试环境
	把测试板rf口与测试设备(如CMW270)rf口对接，测试板上的串口线接到测试设备上

 - 测试板进入ATE模式
	先接上串口线ATE跳线帽，然后上电即进入ATE模式

 - 打开测试通路
	串口输入 ``ble dut`` 命令

 - 进行测试
	按照测试设备使用说明进行BLE非信令测试

2. BT信令测试

 - 搭建测试环境
	把测试板rf口与测试设备(如CMW270)rf口对接，测试板上的串口线接到测试设备上

 - 测试板进入ATE模式
	先接上串口线ATE跳线帽，然后上电即进入ATE模式

 - 打开测试通路
	串口输入 ``ble dut`` 命令

 - 进行测试
	按照测试设备使用说明进行BT信令测试

3. BT非信令测试

 - 搭建测试环境
	把测试板rf口与测试设备(如CMW270)rf口对接，测试板上的串口线接到测试设备上

 - 测试板进入ATE模式
	先接上串口线ATE跳线帽，然后上电即进入ATE模式

 - 打开测试通路
	串口输入 ``ble dut`` 命令

 - 进行测试
	| 测试设备开启RX模式，串口输入TX命令进行TX测试，输入end命令停止TX测试
	| 测试设备开启TX模式，串口输入RX命令进行TX测试，输入end命令停止RX测试

	[TX/RX命令格式]
	  ``01 E0 FC 0C FD UAP LAP2 LAP1 LAP0 Test_Scenarios Hop_mode TX_chnl RX_chnl Interval Packet_Type Tx_Power``

	+-------------------+------------------------------------------------------------------------+
	|01 E0 FC 0C FD     | 固定命令头                                                             |
	+-------------------+------------------------------------------------------------------------+
	|UAP LAP2 LAP1 LAP0 | 测试设备地址，rx时有效                                                 |
	+-------------------+------------------------------------------------------------------------+
	|Test_Scenarios     | 测试模式                                                               |
	|                   |  | 01 : Repeated '00000000' (in transmission order) sequence           |
	|                   |  | 02 : Repeated '11111111' (in transmission order) sequence           |
	|                   |  | 03 : Repeated '10101010' (in transmission order) sequence           |
	|                   |  | 04 : PN9 sequence (in transmission order)                           |
	|                   |  | 07 : rx test                                                        |
	|                   |  | 09 : Repeated '11110000' (in transmission order) sequence           |
	+-------------------+------------------------------------------------------------------------+
	|Hop_mode           | 跳频开关                                                               |
	|                   |  | 00 : off                                                            |
	|                   |  | 01 : on                                                             |
	+-------------------+------------------------------------------------------------------------+
	|TX_chnl            | 发射频点                                                               |
	|                   |  | 0-78,对应频点2402-2480                                              |
	+-------------------+------------------------------------------------------------------------+
	|RX_chnl            | 接收频点                                                               |
	|                   |  | 0-78,对应频点2402-2480（tx和rx channel值要一样）                    |
	+-------------------+------------------------------------------------------------------------+
	|Interval           | 当前未使用                                                             |
	+-------------------+------------------------------------------------------------------------+
	|Packet_Type        | 包类型                                                                 |
	|                   |  | 0 : NULLpkt                                                         |
	|                   |  | 1 : POLLpkt                                                         |
	|                   |  | 2 : FHSpkt                                                          |
	|                   |  | 3 : DM1                                                             |
	|                   |  | 4 : DH1                                                             |
	|                   |  | 5 : HV1                                                             |
	|                   |  | 6 : HV2                                                             |
	|                   |  | 7 : HV3                                                             |
	|                   |  | 8 : DV                                                              |
	|                   |  | 9 : AUX1                                                            |
	|                   |  | 10 : DM3                                                            |
	|                   |  | 11 : DH3                                                            |
	|                   |  | 12 : EV4                                                            |
	|                   |  | 13 : EV5                                                            |
	|                   |  | 14 : DM5                                                            |
	|                   |  | 15 : DH5                                                            |
	|                   |  | 16 : IDpkt                                                          |
	|                   |  | 20 : EDR_2DH1                                                       |
	|                   |  | 21 : EV3                                                            |
	|                   |  | 22 : EDR_2EV3                                                       |
	|                   |  | 23 : EDR_3EV3                                                       |
	|                   |  | 24 : EDR_3DH1                                                       |
	|                   |  | 25 : EDR_AUX1                                                       |
	|                   |  | 26 : EDR_2DH3                                                       |
	|                   |  | 27 : EDR_3DH3                                                       |
	|                   |  | 28 : EDR_2EV5                                                       |
	|                   |  | 29 : EDR_3EV5                                                       |
	|                   |  | 30 : EDR_2DH5                                                       |
	|                   |  | 31 : EDR_3DH5                                                       |
	+-------------------+------------------------------------------------------------------------+
	|Tx_Power           | 当前不生效                                                             |
	+-------------------+------------------------------------------------------------------------+

	[end命令格式]
	  ``01 E0 FC 01 90`` 输入完此命令后串口会收到一个end resp

	[end resp格式]
	  ``04 0E 18 01 E0 FC 90 TxTotolPackets RxTotolPackets RxValidPackets RxHECErrorCntr RxCRCErrorCntr``

	+----------------------+------------------------------------------------------------------------+
	|04 0E 18 01 E0 FC 90  | 应答固定头                                                             |
	+----------------------+------------------------------------------------------------------------+
	|TxTotolPackets        | 发送的总包数，tx 有效                                                  |
	|                      |  | 此参数4个字节，小端显示                                             |
	+----------------------+------------------------------------------------------------------------+
	|RxTotolPackets        | 接收的总包数，rx 有效                                                  |
	|                      |  | 此参数4个字节，小端显示                                             |
	+----------------------+------------------------------------------------------------------------+
	|RxValidPackets        | 接收正确的包数，rx 有效                                                |
	|                      |  | 此参数4个字节，小端显示                                             |
	+----------------------+------------------------------------------------------------------------+
	|RxHECErrorCntr        | HEC错误的包数，rx 有效                                                 |
	|                      |  | 此参数4个字节，小端显示                                             |
	+----------------------+------------------------------------------------------------------------+
	|RxCRCErrorCntr        | CRC错误的包数，rx 有效                                                 |
	|                      |  | 此参数4个字节，小端显示                                             |
	+----------------------+------------------------------------------------------------------------+

	备注：所有命令参数均是16进制格式

	[测试用例]
		| tx  ：``01 e0 fc 0c fd 12 34 56 12 09 00 00 00 01 04 7f``
		| rx ：``01 e0 fc 0c fd 9c bd 35 9c 07 00 00 00 01 04 7f``
		| end tx/rx ：``01 E0 FC 01 90``
		| 接收到的end resp ：``04 0E 18 01 E0 FC 90 DD 13 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00``


参考链接
----------

    `API参考: <../../api-reference/bluetooth/index.html>`_ 介绍了蓝牙API接口

    `开发者指南: <../../developer-guide/bluetooth/index.html>`_ 介绍了蓝牙常用使用场景

    `样例演示: <../../examples/bluetooth/index.html>`_ 介绍了蓝牙样例使用和操作

    `蓝牙工程: <../../projects_work/bluetooth/index.html>`_ 介绍了蓝牙相关工程